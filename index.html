<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <title>å®¢æœæœƒè­°ç³»çµ± v28.3.3 (åŠŸèƒ½å…¨ä¿®å¾©ç‰ˆ)</title>
    
    <script id="database-script">
        window.MEETING_DB = {
  "2026-01-14": {
    "chair": "è•­ç¿Šç¿", "recorder": "é™³ç«è«­", "morning": "è˜‡æ¸…æº", "afternoon": "è”¡ç­‘ç",
    "attendees": ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "ä¿Šç”Ÿéƒ¨é•·"],
    "cards": {
      "col_record": [
        { "title": "AIæ¢è¨èˆ‡ç ”ç©¶", "desc": "2026/01/14ï¼š\n1. å®¢æœå°AIæ¢è¨ã€ä½¿ç”¨è¦†è“‹é‡å¤ªå°‘ã€‚\n2. å¾é£Ÿè¡£ä½è¡Œé–‹å§‹èåˆAIã€‚\n3. NoteBook LMé©åˆè¡Œæ”¿é¡ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" },
        { "title": "ç‰¹æ®ŠåŠ å€¼æœå‹™ç›¸é—œå•é¡Œ", "desc": "2026/01/14ï¼š\nå¾—çæ˜ç´°å¯åˆ—å…¥ã€Œé›»ç£ç´€éŒ„ã€ä¹‹ä¸€ï¼Œè©•ä¼°æ˜¯å¦æ”¶è²»ã€‚", "cat": "å…¨éƒ¨", "owner": "æå®¶æ§¿" }
      ],
      "col_tracking": [
        { "title": "ç¶²é å·¥å–®ç›¸é—œ", "desc": "é‡å°ç¶²é çµ„å»¶é²é–‹å–®çš„æƒ…æ³ï¼Œéœ€ä¸»å‹•ä»‹å…¥äº†è§£ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" },
        { "title": "æ˜æ˜Ÿéº»å°‡ç‰Œå‹å•é¡Œ", "desc": "2026/01/14ï¼šé‚„åœ¨ç¢ºèªä¸­", "cat": "å…¨éƒ¨", "owner": "é™³ç«è«­" }
      ],
      "col_target": []
    }
  },
  "2026-01-21": {
    "chair": "è•­ç¿Šç¿", "recorder": "é™³ç«è«­", "morning": "è˜‡æ¸…æº", "afternoon": "é»ƒå©·éˆº",
    "attendees": ["è˜‡æ¸…æº", "é»ƒå©·éˆº", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­"],
    "cards": {
      "col_record": [
        { "title": "å®¢æœä¾‹æœƒæ™‚é–“ç¢ºèª", "desc": "ç¶­æŒæ¯é€±ä¸‰å¬é–‹ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" },
        { "title": "æœƒè­°è¨˜éŒ„é€²è¡Œ AI åŒ–æ”¹ç‰ˆ", "desc": "è¡Œæ”¿ç›¸é—œä½œæ¥­å°‡é€æ­¥å°å…¥ AI å”åŠ©è™•ç†ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" }
      ],
      "col_tracking": [
        { "title": "å•é¡Œå›å ±è©å½™åˆ†æ", "desc": "é è¨ˆ 02/28 ä¸Šç·šã€‚", "cat": "å…¨éƒ¨", "owner": "è•­ç¿Šç¿" }
      ],
      "col_target": []
    }
  },
  "2026-01-28": {
    "chair": "è”¡ç­‘ç", "recorder": "è•­ç¿Šç¿", "morning": "æ›¾é›ªå¦®", "afternoon": "è”¡ç­‘ç",
    "attendees": ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "æå®¶æ§¿"],
    "cards": {
      "col_record": [
        { "title": "02/26ç¨½æ ¸æ³¨æ„äº‹é …", "desc": "2026/01/28ï¼š\nISOå°‡æ–¼ 2/26 é€²è¡Œç¨½æ ¸ï¼Œè«‹æ³¨æ„å€‹è³‡ç•™å­˜èˆ‡è»Ÿé«”æ›´æ–°ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" },
        { "title": "AIæ‡‰ç”¨ç›¸é—œ", "desc": "éœ€æœ‰æ¸¬è©¦æˆ–ä¿®æ”¹æ­·ç¨‹è¡¨é€²è¡Œè¨˜éŒ„ã€‚", "cat": "å…¨éƒ¨", "owner": "å…¨éƒ¨" }
      ],
      "col_tracking": [
        { "title": "æ˜æ˜Ÿéº»å°‡ç‰Œå‹å•é¡Œ", "desc": "2026/01/28ï¼šå°ˆæ¡ˆè¤‡å¯©ä¸­ï¼Œè‹¥ç©å®¶å†æ¬¡åæ˜ éœ€é™„ LogReplayã€‚", "cat": "å…¨éƒ¨", "owner": "é™³ç«è«­" }
      ],
      "col_target": []
    }
  }
};
    </script>
    <style>
        :root { --bg: #f8fafc; --card-bg: #ffffff; --text-main: #334155; --text-muted: #64748b; --border: #e2e8f0; --accent: #0369a1; --input-bg: #f1f5f9; }
        [data-theme="dark"] { --bg: #0f172a; --card-bg: #1e293b; --text-main: #f8fafc; --text-muted: #94a3b8; --border: #334155; --accent: #38bdf8; --input-bg: #0f172a; }
        * { box-sizing: border-box; transition: 0.2s ease; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text-main); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 80px; background: var(--card-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding: 20px 0; overflow-y: auto; flex-shrink: 0; }
        .side-icon { width: 50px; height: 50px; border-radius: 12px; background: var(--bg); margin-bottom: 15px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid var(--border); color: var(--text-muted); font-size: 0.7rem; text-align: center; }
        .side-icon.active { background: var(--accent); color: white; border-color: var(--accent); }
        .side-add { border: 2px dashed var(--text-muted); font-size: 1.5rem; }
        .main { flex: 1; padding: 25px; display: flex; flex-direction: column; overflow-x: hidden; }
        .header-section { background: var(--card-bg); border-radius: 20px; padding: 20px; margin-bottom: 25px; border: 1px solid var(--border); }
        .info-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        .input-group label { display: block; font-size: 0.75rem; color: var(--text-muted); margin-bottom: 6px; font-weight: bold; }
        .input-group select, .input-group input { background: var(--input-bg); border: 1px solid var(--border); color: var(--text-main); padding: 10px; border-radius: 8px; width: 100%; outline: none; }
        .attendee-list { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; min-height: 42px; padding: 6px; background: var(--input-bg); border-radius: 10px; border: 1px dashed var(--border); }
        .tag { background: rgba(56, 189, 248, 0.1); color: var(--accent); padding: 5px 14px; border-radius: 50px; font-size: 0.85rem; border: 1px solid var(--accent); display: flex; align-items: center; }
        .board { display: flex; flex-wrap: wrap; gap: 20px; flex: 1; overflow-y: auto; align-content: flex-start; }
        .column { background: rgba(0,0,0,0.02); border-radius: 20px; flex: 1 1 350px; padding: 20px; display: flex; flex-direction: column; border: 1px solid var(--border); min-height: 450px; }
        .card { background: var(--card-bg); border-radius: 15px; padding: 18px; margin-bottom: 15px; border: 1px solid var(--border); display: flex; flex-direction: column; position: relative; }
        .card textarea { width: 100%; background: transparent; border: none; color: var(--text-main); resize: none; outline: none; }
        .card .c-title { font-weight: bold; margin-bottom: 8px; border-bottom: 1px solid var(--border); }
        .card .c-desc { font-size: 0.9rem; height: 65px; overflow: hidden; }
        .card .c-desc.expanded { height: auto !important; min-height: 65px; }
        .expand-btn { font-size: 0.8rem; color: var(--accent); text-align: center; cursor: pointer; padding: 4px; border-top: 1px dashed var(--border); margin-top: 5px; }
        
        /* è£œå›ç§»é™¤æŒ‰éˆ•æ¨£å¼ */
        .del-x { cursor: pointer; color: #ef4444; font-weight: bold; position: absolute; top: 10px; right: 15px; display: none; font-size: 0.8rem; }
        .tag .del-tag { cursor: pointer; color: #ef4444; margin-left: 5px; display: none; }
        body[data-edit="true"] .del-x, body[data-edit="true"] .del-tag { display: inline-block; }

        .fab-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 12px; }
        .fab { padding: 12px 25px; border-radius: 50px; font-weight: bold; border: none; cursor: pointer; box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .btn-sync { background: #3b82f6; color: white; }
        .btn-edit { background: #ef4444; color: white; }
        
        /* å½ˆçª—æ¨£å¼ */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: var(--card-bg); padding: 30px; border-radius: 20px; width: 320px; text-align: center; }
    </style>
</head>
<body data-theme="dark" data-edit="false">

<div class="modal-overlay" id="dateModal">
    <div class="modal-content">
        <h3 style="color:var(--accent)">ğŸ“… å»ºç«‹æ–°æœƒè­°</h3>
        <input type="date" id="newMeetingDate" style="padding:8px; width:100%;">
        <button onclick="confirmNewMeeting()" style="background:var(--accent); color:white; border:none; padding:10px 20px; border-radius:50px; margin-top:15px; cursor:pointer;">å»ºç«‹ä¸¦ç¹¼æ‰¿è³‡æ–™</button>
        <p style="cursor:pointer; font-size:0.8rem; color:var(--text-muted);" onclick="closeModal()">å–æ¶ˆ</p>
    </div>
</div>

<div class="sidebar" id="dateSidebar">
    <div class="side-icon side-add" onclick="openModal()">+</div>
</div>

<div class="main">
    <div class="header-section">
        <div id="syncStatus" style="font-size: 0.8rem; color: var(--accent); margin-bottom: 10px;">â˜ï¸ é€£ç·šä¸­...</div>
        <div class="info-row">
            <div class="input-group"><label>ğŸ“… å ±å‘Šæ—¥æœŸ</label><input type="text" id="mDateDisplay" readonly></div>
            <div class="input-group"><label>ğŸ‘¤ ä¸»å¸­</label><select id="mChair" class="global-lock" disabled></select></div>
            <div class="input-group"><label>ğŸ“ ç´€éŒ„</label><select id="mRecorder" class="global-lock" disabled></select></div>
            <div class="input-group">
                <label>ğŸ‘¥ å‡ºå¸­äººå“¡ (ç·¨è¼¯æ¨¡å¼é–‹å•Ÿå¾Œå¯é»åå­—ç§»é™¤)</label>
                <select id="mAttendeeSelect" class="global-lock" onchange="addAttendee(this.value); this.value='';" disabled>
                    <option value="">-- æ–°å¢äººå“¡ --</option>
                </select>
            </div>
        </div>
        <div class="attendee-list" id="attendeeList"></div>
    </div>

    <div class="board">
        <div class="column"><b>ğŸ“ å¹¹éƒ¨æœƒè­°æ±ºè­°</b><div id="col_record"></div><button class="global-lock" onclick="addNewCard('col_record')" disabled>+ æ–°å¢æ±ºè­°</button></div>
        <div class="column"><b>ğŸ“ è¿½è¹¤äº‹é …</b><div id="col_tracking"></div><button class="global-lock" onclick="addNewCard('col_tracking')" disabled>+ æ–°å¢è¿½è¹¤</button></div>
        <div class="column"><b>ğŸ“ å¹´åº¦ç›®æ¨™</b><div id="col_target"></div><button class="global-lock" onclick="addNewCard('col_target')" disabled>+ æ–°å¢é€²åº¦</button></div>
    </div>
</div>

<div class="fab-container">
    <button class="fab btn-edit" id="editToggleBtn" onclick="toggleEditMode()">ğŸ”’ ç·¨è¼¯æ¨¡å¼</button>
    <button class="fab btn-sync" onclick="syncDataToCloud()">â˜ï¸ åŒæ­¥è‡³é›²ç«¯</button>
</div>

<script>
    const CLOUD_API_URL = "https://script.google.com/macros/s/AKfycbxtfU8YUXCQyea1qh8khk1XbUN-zd1XzoGsNJcjruVThrSt3r7uW1XtzAexOK5rQ6sfiA/exec";
    const cadres = ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "é»ƒå©·éˆº", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "æå®¶æ§¿", "ä¿Šç”Ÿéƒ¨é•·"];
    let meetings = window.MEETING_DB;
    let currentDay = "";

    async function init() {
        setupSelects();
        await fetchCloudData();
        currentDay = Object.keys(meetings).sort().reverse()[0];
        loadMeeting(currentDay);
    }

    async function fetchCloudData() {
        try {
            const res = await fetch(CLOUD_API_URL);
            const data = await res.json();
            if (data && Object.keys(data).length > 0) {
                meetings = data;
                document.getElementById('syncStatus').innerText = "â˜ï¸ é›²ç«¯åŒæ­¥å®Œæˆ";
            }
        } catch (e) {
            document.getElementById('syncStatus').innerText = "âš ï¸ è®€å–å¤±æ•—ï¼Œç¬¬ä¸€æ¬¡è«‹é»åŒæ­¥";
        }
    }

    async function syncDataToCloud() {
        saveCurrentToVariable();
        document.getElementById('syncStatus').innerText = "â³ åŒæ­¥ä¸­...";
        try {
            await fetch(CLOUD_API_URL, { method: 'POST', body: JSON.stringify(meetings) });
            alert("é›²ç«¯åŒæ­¥æˆåŠŸï¼");
            document.getElementById('syncStatus').innerText = "âœ… åŒæ­¥æˆåŠŸ";
        } catch (e) { alert("åŒæ­¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥æ¬Šé™"); }
    }

    function setupSelects() {
        ['mChair', 'mRecorder', 'mAttendeeSelect'].forEach(id => {
            const el = document.getElementById(id);
            cadres.forEach(name => el.add(new Option(name, name)));
        });
    }

    function loadMeeting(date) {
        currentDay = date;
        document.getElementById('mDateDisplay').value = date;
        const data = meetings[date] || { attendees: [], cards: { col_record: [], col_tracking: [], col_target: [] } };
        document.getElementById('mChair').value = data.chair || "";
        document.getElementById('mRecorder').value = data.recorder || "";
        document.getElementById('attendeeList').innerHTML = "";
        (data.attendees || []).forEach(n => addAttendee(n));
        ['col_record', 'col_tracking', 'col_target'].forEach(id => {
            document.getElementById(id).innerHTML = "";
            if (data.cards && data.cards[id]) data.cards[id].forEach(c => addNewCard(id, c));
        });
        refreshSidebar();
    }

    function saveCurrentToVariable() {
        meetings[currentDay] = {
            chair: document.getElementById('mChair').value,
            recorder: document.getElementById('mRecorder').value,
            attendees: Array.from(document.querySelectorAll('.tag')).map(t => t.innerText.replace('âœ•', '').trim()),
            cards: {
                col_record: getCardData('col_record'),
                col_tracking: getCardData('col_tracking'),
                col_target: getCardData('col_target')
            }
        };
    }

    function getCardData(id) {
        return Array.from(document.getElementById(id).querySelectorAll('.card')).map(c => ({
            title: c.querySelector('.c-title').value,
            desc: c.querySelector('.c-desc').value
        }));
    }

    function addNewCard(colId, d = { title: 'æ¨™é¡Œ', desc: 'å…§å®¹...' }) {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="del-x" onclick="this.parentElement.remove()">ç§»é™¤âœ•</div>
            <textarea class="c-title" rows="1" disabled>${d.title}</textarea>
            <textarea class="c-desc" disabled>${d.desc}</textarea>
            <div class="expand-btn" onclick="toggleExpand(this)">â–¼ å±•é–‹</div>`;
        document.getElementById(colId).appendChild(card);
    }

    function addAttendee(name) {
        if (!name) return;
        const list = document.getElementById('attendeeList');
        const tag = document.createElement('div'); tag.className = 'tag';
        tag.innerHTML = `${name} <span class="del-tag" onclick="this.parentElement.remove()">âœ•</span>`;
        list.appendChild(tag);
    }

    function toggleEditMode() {
        const isEdit = document.body.getAttribute('data-edit') === 'false';
        document.body.setAttribute('data-edit', isEdit);
        document.getElementById('editToggleBtn').innerText = isEdit ? "ğŸ”“ æª¢è¦–æ¨¡å¼" : "ğŸ”’ ç·¨è¼¯æ¨¡å¼";
        document.querySelectorAll('.global-lock, textarea, select, button').forEach(el => el.disabled = !isEdit);
    }

    function toggleExpand(btn) {
        const desc = btn.parentElement.querySelector('.c-desc');
        if (desc.classList.contains('expanded')) {
            desc.classList.remove('expanded');
            desc.style.height = '65px';
            btn.innerText = "â–¼ å±•é–‹";
        } else {
            desc.classList.add('expanded');
            desc.style.height = desc.scrollHeight + 'px';
            btn.innerText = "â–² æ”¶åˆ";
        }
    }

    function refreshSidebar() {
        const bar = document.getElementById('dateSidebar');
        Array.from(bar.querySelectorAll('.side-icon:not(.side-add)')).forEach(el => el.remove());
        Object.keys(meetings).sort().reverse().forEach(date => {
            const btn = document.createElement('div');
            btn.className = `side-icon ${date === currentDay ? 'active' : ''}`;
            btn.innerHTML = date.substring(5);
            btn.onclick = () => loadMeeting(date);
            bar.insertBefore(btn, bar.lastElementChild);
        });
    }

    function openModal() { document.getElementById('dateModal').style.display = 'flex'; }
    function closeModal() { document.getElementById('dateModal').style.display = 'none'; }
    function confirmNewMeeting() {
        const date = document.getElementById('newMeetingDate').value;
        if (!date || meetings[date]) return;
        meetings[date] = JSON.parse(JSON.stringify(meetings[currentDay]));
        meetings[date].cards.col_record = [];
        loadMeeting(date);
        closeModal();
    }

    window.onload = init;
</script>
</body></html>
