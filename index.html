<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <title>å®¢æœæœƒè­°ç³»çµ± v28.3.1 (é›²ç«¯è³‡æ–™è£œé½Šç‰ˆ)</title>
    
    <script id="database-script">
        window.MEETING_DB = {
  "2026-01-14": {
    "chair": "è•­ç¿Šç¿",
    "recorder": "é™³ç«è«­",
    "morning": "è˜‡æ¸…æº",
    "afternoon": "è”¡ç­‘ç",
    "attendees": ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "ä¿Šç”Ÿéƒ¨é•·"],
    "cards": {
      "col_record": [
        {
          "title": "AIæ¢è¨èˆ‡ç ”ç©¶",
          "desc": "2026/01/14ï¼š\n1. å®¢æœå°AIæ¢è¨ã€ä½¿ç”¨è¦†è“‹é‡å¤ªå°‘ã€‚\n2. å¾é£Ÿè¡£ä½è¡Œé–‹å§‹èåˆAIã€‚\n3. NoteBook LMé©åˆè¡Œæ”¿é¡ï¼Œç®¡ç†è·æœ‰å¾ˆå¤šä½¿ç”¨AIçš„ç©ºé–“ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "ç‰¹æ®ŠåŠ å€¼æœå‹™ç›¸é—œå•é¡Œ",
          "desc": "2026/01/14ï¼š\nå¾—çæ˜ç´°å¯åˆ—å…¥ã€Œé›»ç£ç´€éŒ„ã€ä¹‹ä¸€ï¼Œè©•ä¼°æ˜¯å¦æ”¶è²»ï¼Œè¦å‰‡å¯å®šï¼Œä½†å¯å½ˆæ€§ä¸æ”¶ã€‚\nï¼ˆæ­¤é …éœ€èˆ‡éƒ¨é•·é‡æ–°ç¢ºèªå¾—çæ˜ç´°çš„ç‰¹æ®Šæ€§ï¼‰",
          "cat": "å…¨éƒ¨",
          "owner": "æå®¶æ§¿"
        }
      ],
      "col_tracking": [
        {
          "title": "ç¶²é å·¥å–®ç›¸é—œï¼ˆç½®é ‚ä¿ç•™ï¼‰",
          "desc": "2025/10/01ï¼š\né‡å°ç¶²é çµ„å»¶é²é–‹å–®çš„æƒ…æ³ï¼Œéœ€ä¸»å‹•ä»‹å…¥äº†è§£ï¼Œè‹¥èˆ‡ç¶²é çµ„é…åˆé–‹å–®å»¶é²éä¹…ï¼Œè«‹ç›´æ¥èˆ‡è‰å¤§åæ‡‰ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "redmineæ¡ˆä»¶è¿½è¹¤ç›¸é—œï¼ˆç½®é ‚ä¿ç•™ï¼‰",
          "desc": "2025/12/10ï¼š\n1.è¿½å–®æµç¨‹ï¼šå¦‚é€é LINE è¿½è¹¤ï¼Œå‹™å¿…ç•™ä¸‹ç´€éŒ„ä¸¦æ“·å–ç•«é¢ä½œç‚ºè­‰æ˜ã€‚\n2.å†·è™•ç†çš„æ¡ˆä»¶ï¼šè¦æœ‰æ™‚é™ï¼Œè«‹å°ˆæ¡ˆè¦å¯«æ¸…æ¥šï¼Œè‹¥ç¢ºèªé•è¦è«‹æé†’å°ˆæ¡ˆä½¿ç”¨éŠæˆ²è¦ç« å›è¦†ã€‚\n3.å…§éƒ¨å»ºè­°å–®ï¼šéœ€è¦æœ‰è¿½å–®é€²åº¦å‚™è¨»ã€‚\n4.å¤§é‡è¿½å–®ï¼šè«‹ç”¨ä¿¡ä»¶å¯„å‡ºé€šçŸ¥å°ˆæ¡ˆã€‚\n5.ç•°å¸¸BUGå•é¡Œï¼šè«‹ç•™ä¸‹å°è©±è¨˜éŒ„ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "ç¨½æ ¸ç›¸é—œï¼ˆç½®é ‚ä¿ç•™ï¼‰",
          "desc": "2025/12/24ï¼š\n1.æ­·å²èˆŠå–®ï¼šé ˆæŒçºŒè¿½è¹¤è™•ç†ï¼ˆISO ç¨½æ ¸ä»Šå¹´çš„æ¡ˆä»¶ç‰¹åˆ¥è¢«åˆ—ç‚ºã€Œè§€å¯Ÿã€ï¼Œæ˜å¹´ä¸€å®šæœƒå†æ¬¡é€²è¡Œç¨½æ ¸ï¼‰\n2.è³‡å®‰å–®ï¼šå¿…é ˆåœ¨ 1 å€‹æœˆå…§ å®Œæˆçµæ¡ˆã€‚\n3.äº¤æ¥å–®ï¼šæ¯ 3 å€‹æœˆ å®šæœŸæ¸…ç†ä¸€æ¬¡ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "æ˜æ˜Ÿéº»å°‡ç‰Œå‹å•é¡Œ",
          "desc": "2026/01/07ï¼šæ˜æ˜ŸåŒå±€å‡ºç¾5æ”¯ç‰Œå‹ï¼ŒæŸ¥è©¢å›å ±é‡ï¼Œå›å ±å°ˆæ¡ˆ\n2026/01/14ï¼šé‚„åœ¨ç¢ºèªä¸­",
          "cat": "å…¨éƒ¨",
          "owner": "é™³ç«è«­"
        },
        {
          "title": "å•é¡Œå›å ±è©å½™åˆ†æ",
          "desc": "2025/11/26ï¼šå•é¡Œå›å ±è©å½™åˆ†æå·²å®Œæˆï¼Œéœ€ç¢ºèªèˆ‡åŸä½œæ¥­æµç¨‹æœ‰ç„¡å·®ç•°ã€‚\n2025/12/31ï¼šTableau ç‰ˆé¢å·²èª¿æ•´å®Œæˆï¼Œå¾…ç¢ºèªå‚™è¨»ç­†è¨˜å°æ‡‰ä¹‹é€£çµå·¥å…·ã€‚\n2026/01/14ï¼šå±•ç¤ºå¾Œå¯ä»¥ç¹¼çºŒè£½ä½œï¼Œé ˆæ³¨æ„åˆ†æå¾Œçš„çµæœï¼Œé¿å…éé›œäº‚",
          "cat": "å…¨éƒ¨",
          "owner": "è•­ç¿Šç¿"
        }
      ],
      "col_target": []
    }
  },
  "2026-01-21": {
    "chair": "è•­ç¿Šç¿",
    "recorder": "é™³ç«è«­",
    "morning": "è˜‡æ¸…æº",
    "afternoon": "é»ƒå©·éˆº",
    "attendees": ["è˜‡æ¸…æº", "é»ƒå©·éˆº", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­"],
    "cards": {
      "col_record": [
        {
          "title": "å®¢æœä¾‹æœƒæ™‚é–“ç¢ºèª",
          "desc": "2026/01/21ï¼šå®¢æœä¾‹æœƒæ™‚ç¨‹ç„¡èª¿æ•´ï¼Œç¶­æŒæ¯é€±ä¸‰å¬é–‹ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "æœƒè­°è¨˜éŒ„é€²è¡Œ AI åŒ–æ”¹ç‰ˆ",
          "desc": "2026/01/21ï¼šæœƒè­°è¨˜éŒ„é€²è¡Œ AI åŒ–æ”¹ç‰ˆï¼Œè¡Œæ”¿ç›¸é—œä½œæ¥­å°‡é€æ­¥å°å…¥ AI å”åŠ©è™•ç†ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        }
      ],
      "col_tracking": [
        {
          "title": "ç¶²é å·¥å–®ç›¸é—œï¼ˆç½®é ‚ä¿ç•™ï¼‰",
          "desc": "2025/10/01ï¼šé‡å°ç¶²é çµ„å»¶é²é–‹å–®çš„æƒ…æ³ï¼Œéœ€ä¸»å‹•ä»‹å…¥äº†è§£ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "å•é¡Œå›å ±è©å½™åˆ†æ",
          "desc": "2026/01/21ï¼šç›®å‰å°šæœªå®Œæˆä¸²æ¥ï¼Œä¸Šç·šæ™‚é–“æš«å®šé è¨ˆ 02/28 ä¸Šç·šã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "è•­ç¿Šç¿"
        }
      ],
      "col_target": []
    }
  },
  "2026-01-28": {
    "chair": "è”¡ç­‘ç",
    "recorder": "è•­ç¿Šç¿",
    "morning": "æ›¾é›ªå¦®",
    "afternoon": "è”¡ç­‘ç",
    "attendees": ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "æå®¶æ§¿"],
    "cards": {
      "col_record": [
        {
          "title": "02/26ç¨½æ ¸æ³¨æ„äº‹é …",
          "desc": "2026/01/28ï¼š\nå€‹äººè³‡æ–™æ´©æ¼é˜²è­·èª²ç¨‹å·²å®Œæˆï¼ŒISOå°‡æ–¼ 2026/2/26 é€²è¡Œç¨½æ ¸ï¼Œè«‹å¤§å®¶é…åˆï¼š\n1.ä¿¡ç®±å¯„ä»¶å‚™ä»½åˆªé™¤\n2.å£“ç¸®ç¨‹å¼éœ€ç‚º RAR\n3.é˜²æ¯’èˆ‡Windowsæ›´æ–°\n4.Redmineå–®å‹¿é™„èº«åˆ†è­‰å½±æœ¬\n5.Lineå‹¿ç•™å€‹è³‡",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        },
        {
          "title": "AIæ‡‰ç”¨ç›¸é—œ",
          "desc": "å®¢æœå¿«å ±ã€èªéŸ³è³ªæª¢ç­‰æ¸¬è©¦éœ€æœ‰æ­·ç¨‹è¡¨è¨˜éŒ„ã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "å…¨éƒ¨"
        }
      ],
      "col_tracking": [
        {
          "title": "æ˜æ˜Ÿéº»å°‡ç‰Œå‹å•é¡Œ",
          "desc": "2026/01/28ï¼šå°ˆæ¡ˆè¤‡å¯©ï¼šç ”ç™¼æ¨æ¸¬ç‚ºç¶²è·¯å»¶é²é€ æˆï¼Œç›®å‰æœªèƒ½é‡ç¾ã€‚è‹¥ç©å®¶å†æ¬¡åæ˜ éœ€é™„ä¸Šå‰å¾Œä¸€æ­¥ç‰Œå±€è³‡è¨Šã€‚",
          "cat": "å…¨éƒ¨",
          "owner": "é™³ç«è«­"
        }
      ],
      "col_target": []
    }
  }
};
    </script>
    <style>
        :root { --bg: #f8fafc; --card-bg: #ffffff; --text-main: #334155; --text-muted: #64748b; --border: #e2e8f0; --accent: #0369a1; --input-bg: #f1f5f9; }
        [data-theme="dark"] { --bg: #0f172a; --card-bg: #1e293b; --text-main: #f8fafc; --text-muted: #94a3b8; --border: #334155; --accent: #38bdf8; --input-bg: #0f172a; }
        * { box-sizing: border-box; transition: 0.2s ease; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text-main); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 80px; background: var(--card-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding: 20px 0; overflow-y: auto; flex-shrink: 0; }
        .side-icon { width: 50px; height: 50px; border-radius: 12px; background: var(--bg); margin-bottom: 15px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid var(--border); color: var(--text-muted); font-size: 0.7rem; text-align: center; }
        .side-icon.active { background: var(--accent); color: white; border-color: var(--accent); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .side-add { border: 2px dashed var(--text-muted); font-size: 1.5rem; }
        .main { flex: 1; padding: 25px; display: flex; flex-direction: column; overflow-x: hidden; }
        .header-section { background: var(--card-bg); border-radius: 20px; padding: 20px; margin-bottom: 25px; border: 1px solid var(--border); }
        .info-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .status-row { display: grid; grid-template-columns: 1fr 450px; gap: 25px; padding-top: 15px; border-top: 1px solid var(--border); }
        .input-group label { display: block; font-size: 0.75rem; color: var(--text-muted); margin-bottom: 6px; font-weight: bold; }
        .input-group select, .input-group input { background: var(--input-bg); border: 1px solid var(--border); color: var(--text-main); padding: 10px; border-radius: 8px; width: 100%; outline: none; font-size: 0.9rem; }
        .attendee-list { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; min-height: 42px; padding: 6px; background: var(--input-bg); border-radius: 10px; border: 1px dashed var(--border); }
        .tag { background: rgba(56, 189, 248, 0.1); color: var(--accent); padding: 5px 14px; border-radius: 50px; font-size: 0.85rem; border: 1px solid var(--accent); display: flex; align-items: center; gap: 8px; font-weight: bold; }
        .del-x { cursor: pointer; color: #ef4444; font-weight: bold; display: none; margin-left: 5px; }
        body[data-edit="true"] .del-x { display: inline-block !important; }
        .board { display: flex; flex-wrap: wrap; gap: 20px; flex: 1; overflow-y: auto; align-content: flex-start; }
        .column { background: rgba(0,0,0,0.02); border-radius: 20px; flex: 1 1 350px; padding: 20px; display: flex; flex-direction: column; border: 1px solid var(--border); min-height: 450px; }
        .column-title { font-weight: bold; margin-bottom: 20px; color: var(--accent); border-bottom: 2px solid var(--accent); padding-bottom: 8px; }
        .card { background: var(--card-bg); border-radius: 15px; padding: 18px; margin-bottom: 15px; border: 1px solid var(--border); position: relative; display: flex; flex-direction: column; }
        .card textarea { width: 100%; background: transparent; border: none; color: var(--text-main); resize: none; font-family: inherit; outline: none; line-height: 1.6; }
        .card .c-title { font-size: 1rem; font-weight: bold; margin-bottom: 8px; border-bottom: 1px solid var(--border); padding-bottom: 5px; min-height: 35px; }
        .card .c-desc { font-size: 0.9rem; height: 65px; overflow: hidden; transition: height 0.3s ease-in-out; margin-bottom: 5px; }
        .card .c-desc.expanded { overflow: visible; height: auto !important; }
        .expand-btn { font-size: 0.8rem; color: var(--accent); text-align: center; cursor: pointer; padding: 4px; margin-top: auto; border-top: 1px dashed var(--border); font-weight: bold; }
        .fab-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 12px; z-index: 900; }
        .fab { padding: 12px 25px; border-radius: 50px; font-weight: bold; border: none; cursor: pointer; box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .btn-sync { background: #3b82f6; color: white; box-shadow: 0 0 15px rgba(59, 130, 246, 0.4); }
        .btn-edit { background: #ef4444; color: white; }
    </style>
</head>
<body data-theme="dark" data-edit="false">

<div class="sidebar" id="dateSidebar">
    <div class="side-icon side-add" id="btnSideAdd" onclick="openModal()">+</div>
</div>

<div class="main">
    <div class="header-section">
        <div class="info-row" id="syncStatus" style="font-size: 0.8rem; color: var(--accent); margin-bottom: 10px;">â˜ï¸ æ­£åœ¨é€£ç·šé›²ç«¯è³‡æ–™åº«...</div>
        <div class="info-row">
            <div class="input-group"><label>ğŸ“… å ±å‘Šæ—¥æœŸ</label><input type="text" id="mDateDisplay" readonly="" style="font-weight:bold; color:var(--accent);"></div>
            <div class="input-group"><label>ğŸ‘¤ ä¸»å¸­</label><select id="mChair" class="global-lock" disabled=""></select></div>
            <div class="input-group"><label>ğŸ“ ç´€éŒ„</label><select id="mRecorder" class="global-lock" disabled=""></select></div>
        </div>
        <div class="status-row">
            <div class="attendance-section">
                <div class="input-group"><label>ğŸ‘¥ å‡ºå¸­äººå“¡</label><select id="mAttendeeSelect" class="global-lock" onchange="addAttendee(this.value); this.value='';" disabled=""><option value="">-- è«‹æŒ‘é¸äººå“¡ --</option></select></div>
                <div id="attendeeList" class="attendee-list"></div>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <div class="input-group"><label>â˜€ï¸ æ—©ç­å ±å‘Š</label><select id="mRepMorning" class="global-lock" disabled=""></select></div>
                <div class="input-group" style="border-left: 4px solid #15803d; padding-left:12px;"><label>â›… ä¸­ç­å ±å‘Š</label><select id="mRepAfternoon" class="global-lock" disabled=""></select></div>
            </div>
        </div>
    </div>
    <div class="board">
        <div class="column"><div class="column-title">ğŸ“ å¹¹éƒ¨æœƒè­°ç´€éŒ„å…§å®¹</div><div id="col_record"></div><button class="add-btn global-lock" onclick="addNewCard('col_record')" disabled="">+ æ–°å¢æ±ºè­°</button></div>
        <div class="column"><div class="column-title" style="color:#15803d">ğŸ“ è¿½è¹¤äº‹é …ç›¤é»</div><div id="col_tracking"></div><button class="add-btn global-lock" onclick="addNewCard('col_tracking')" disabled="">+ æ–°å¢è¿½è¹¤</button></div>
        <div class="column"><div class="column-title" style="color:#b45309">ğŸ“ 2026å¹´åº¦ç›®æ¨™é€²åº¦</div><div id="col_target"></div><button class="add-btn global-lock" onclick="addNewCard('col_target')" disabled="">+ æ–°å¢é€²åº¦</button></div>
    </div>
</div>

<div class="fab-container">
    <button class="fab btn-theme" onclick="toggleTheme()">ğŸŒ“ åˆ‡æ›é»‘ç™½</button>
    <button class="fab btn-edit" id="editToggleBtn" onclick="toggleEditMode()">ğŸ”’ ç·¨è¼¯æ¨¡å¼</button>
    <button class="fab btn-sync" onclick="syncDataToCloud()">â˜ï¸ åŒæ­¥è‡³é›²ç«¯</button>
</div>

<script>
    const CLOUD_API_URL = "https://script.google.com/macros/library/d/1qHWsYkk-7tiwpqNH_24JdZHSbLUfbjvjtSHGAXFYHpbSqoBeq4RmWr-w/1"; 
    const cadres = ["è˜‡æ¸…æº", "æ›¾é›ªå¦®", "é»ƒå©·éˆº", "è”¡ç­‘ç", "è•­ç¿Šç¿", "é™³ç«è«­", "æå®¶æ§¿", "ä¿Šç”Ÿéƒ¨é•·"];
    let meetings = window.MEETING_DB;
    let currentDay = "";

    async function init() {
        setupSelects();
        await fetchCloudData();
        currentDay = Object.keys(meetings).sort().reverse()[0];
        loadMeeting(currentDay);
    }

    async function fetchCloudData() {
        try {
            const res = await fetch(CLOUD_API_URL);
            const data = await res.json();
            if (data && Object.keys(data).length > 0) { meetings = data; document.getElementById('syncStatus').innerText = "â˜ï¸ é›²ç«¯è³‡æ–™åŒæ­¥å®Œæˆ"; }
        } catch (e) { document.getElementById('syncStatus').innerText = "âš ï¸ è®€å–é›²ç«¯å¤±æ•—ï¼Œä½¿ç”¨æœ¬åœ°é è¨­"; }
    }

    async function syncDataToCloud() {
        saveCurrentToVariable();
        document.getElementById('syncStatus').innerText = "â³ æ­£åœ¨åŒæ­¥...";
        try {
            const res = await fetch(CLOUD_API_URL, { method: 'POST', body: JSON.stringify(meetings) });
            const text = await res.text();
            alert(text);
            document.getElementById('syncStatus').innerText = "âœ… åŒæ­¥å®Œæˆ";
        } catch (e) { alert("åŒæ­¥å¤±æ•—ï¼š" + e); }
    }

    function setupSelects() {
        const ids = ['mChair', 'mRecorder', 'mRepMorning', 'mRepAfternoon', 'mAttendeeSelect'];
        ids.forEach(id => {
            const el = document.getElementById(id);
            cadres.forEach(name => { if(name!=="ä¿Šç”Ÿéƒ¨é•·" || id==="mAttendeeSelect") el.add(new Option(name, name)); });
        });
    }

    function loadMeeting(date) {
        currentDay = date;
        document.getElementById('mDateDisplay').value = date;
        const data = meetings[date] || { attendees: [], cards: { col_record: [], col_tracking: [], col_target: [] } };
        document.getElementById('mChair').value = data.chair || "";
        document.getElementById('mRecorder').value = data.recorder || "";
        document.getElementById('mRepMorning').value = data.morning || "";
        document.getElementById('mRepAfternoon').value = data.afternoon || "";
        document.getElementById('attendeeList').innerHTML = "";
        (data.attendees || []).forEach(n => addAttendee(n));
        ['col_record', 'col_tracking', 'col_target'].forEach(id => {
            document.getElementById(id).innerHTML = "";
            if (data.cards && data.cards[id]) data.cards[id].forEach(c => addNewCard(id, c));
        });
        refreshSidebar();
        updateLocks();
    }

    function saveCurrentToVariable() {
        meetings[currentDay] = {
            chair: document.getElementById('mChair').value,
            recorder: document.getElementById('mRecorder').value,
            morning: document.getElementById('mRepMorning').value,
            afternoon: document.getElementById('mRepAfternoon').value,
            attendees: Array.from(document.querySelectorAll('.tag')).map(t => t.innerText.replace('âœ•', '').trim()),
            cards: { col_record: getCardData('col_record'), col_tracking: getCardData('col_tracking'), col_target: getCardData('col_target') }
        };
    }

    function getCardData(id) {
        return Array.from(document.getElementById(id).querySelectorAll('.card')).map(c => ({
            title: c.querySelector('.c-title').value,
            desc: c.querySelector('.c-desc').value,
            cat: c.querySelector('.m-cat').value,
            owner: c.querySelector('.m-own').value
        }));
    }

    function addNewCard(colId, d = { title: 'äº‹é …åç¨±', desc: 'å…§å®¹è©³æƒ…...', cat: 'å…¨éƒ¨', owner: 'å…¨éƒ¨' }) {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="del-x" style="position:absolute; top:10px; right:15px; cursor:pointer;" onclick="this.parentElement.remove()">ç§»é™¤âœ•</div>
            <textarea class="c-title" rows="1">${d.title}</textarea>
            <textarea class="c-desc">${d.desc}</textarea>
            <div class="expand-btn" onclick="toggleExpand(this)">â–¼ å±•é–‹</div>
            <div class="card-meta">
                <select class="m-cat">${["å®¢æœ","VIP","æ•¸æ“š","å…¨éƒ¨"].map(c=>`<option ${d.cat===c?'selected':''}>${c}</option>`).join('')}</select>
                <select class="m-own">${cadres.map(n=>`<option ${d.owner===n?'selected':''}>${n}</option>`).join('')}</select>
            </div>`;
        document.getElementById(colId).appendChild(card);
        updateLocks();
    }

    function addAttendee(name) {
        const list = document.getElementById('attendeeList');
        if (Array.from(list.querySelectorAll('.tag')).some(t => t.innerText.includes(name))) return;
        const tag = document.createElement('div'); tag.className = 'tag';
        tag.innerHTML = `${name} <span class="del-x" onclick="this.parentElement.remove()">âœ•</span>`;
        list.appendChild(tag);
    }

    function refreshSidebar() {
        const bar = document.getElementById('dateSidebar');
        Array.from(bar.querySelectorAll('.side-icon:not(.side-add)')).forEach(el => el.remove());
        Object.keys(meetings).sort().reverse().forEach(date => {
            const btn = document.createElement('div');
            btn.className = `side-icon ${date === currentDay ? 'active' : ''}`;
            btn.innerHTML = date.substring(5).replace('-', '/');
            btn.onclick = () => loadMeeting(date);
            bar.insertBefore(btn, bar.lastElementChild);
        });
    }

    function toggleEditMode() {
        const isEdit = document.body.getAttribute('data-edit') === 'false';
        document.body.setAttribute('data-edit', isEdit);
        document.getElementById('editToggleBtn').innerText = isEdit ? "ğŸ”“ æª¢è¦–æ¨¡å¼" : "ğŸ”’ ç·¨è¼¯æ¨¡å¼";
        updateLocks();
    }

    function updateLocks() {
        const isEdit = document.body.getAttribute('data-edit') === 'true';
        document.querySelectorAll('.global-lock, textarea, select, .add-btn').forEach(el => el.disabled = !isEdit);
    }

    function toggleExpand(btn) {
        const desc = btn.parentElement.querySelector('.c-desc');
        if (desc.classList.contains('expanded')) {
            desc.classList.remove('expanded');
            desc.style.height = '65px';
            btn.innerText = "â–¼ å±•é–‹";
        } else {
            desc.classList.add('expanded');
            desc.style.height = desc.scrollHeight + 'px';
            btn.innerText = "â–² æ”¶åˆ";
        }
    }

    function toggleTheme() { document.body.setAttribute('data-theme', document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'); }
    function openModal() { document.getElementById('dateModal').style.display = 'flex'; }
    function closeModal() { document.getElementById('dateModal').style.display = 'none'; }
    window.onload = init;
</script>
</body></html>
